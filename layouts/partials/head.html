<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- start ogp -->
    <meta property="og:site_name" content="{{ .Site.Title }}">
    <meta property="og:type" content="article">

    {{ if .Params.thumbnail }}
    <meta property="og:image" content="{{ .Site.BaseURL }}{{ .Params.thumbnail }}">
    <meta property="twitter:image" content="{{ .Site.BaseURL }}{{ .Params.thumbnail }}" />
    {{ else if .Params.image}}
    <meta property="og:image" content="{{ .Site.BaseURL }}{{ .Params.image }}">
    <meta property="twitter:image" content="{{ .Site.BaseURL }}{{ .Params.image }}" />
    {{ else }}
    <meta property="og:image" content="{{ .Site.BaseURL }}/{{ .Site.Params.header_image }}">
    <meta property="twitter:image" content="{{ .Site.BaseURL }}/{{ .Site.Params.header_image }}" />
    {{ end }}

    {{ if .Params.title }}
    <meta name="title" content="{{ .Params.title }}" />
    <meta property="og:title" content="{{ .Params.title }}" />
    <meta property="twitter:title" content="{{ .Params.title }}" />
    {{ else }}
    <meta name="title" content="{{ .Site.Params.title }}" />
    <meta property="og:title" content="{{ .Site.Params.title }}" />
    <meta property="twitter:title" content="{{ .Site.Params.title }}" />
    {{ end }}

    {{ if .Params.description }}
    <meta name="description" content="{{ .Params.description }}">
    <meta property="og:description" content="{{ .Params.description }}" />
    <meta property="twitter:description" content="{{ .Params.description }}" />
    {{ else }}
    <meta name="description" content="{{ .Site.Params.description }}">
    <meta property="og:description" content="{{ .Site.Params.description }}" />
    <meta property="twitter:description" content="{{ .Site.Params.description }}" />
    {{ end }}

    <meta property="og:url" content="{{ .Permalink }}" />

    {{ if .Params.summary }}
    <meta property="twitter:card" content="{{ .Params.summary }}" />
    {{ else }}
    <meta property="twitter:card" content="summary" />
    {{ end }}
    <!-- end ogp -->

    <meta name="keyword"  content="{{ .Site.Params.keyword }}">
    <link rel="icon" type="image/png" href="{{ "img/avatar.png" | relURL }}">
    <link rel="shortcut icon" href="{{ "img/avatar.png" | relURL }}">

    <title>{{ if .Title }}{{ .Title }}{{ else }}{{ .Site.Params.SEOTitle }}{{ end }}</title>

    <link rel="canonical" href="{{ .RelPermalink }}">

    {{ if .Site.Params.disqus_proxy }}
    <link rel="stylesheet" href="{{ "css/iDisqus.min.css" | relURL }}"/>
    {{ end }}

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="{{ "css/bootstrap.min.css" | relURL }}">

    <!-- Clean White theme CSS -->
    <link rel="stylesheet" href="{{ "css/hugo-theme-cleanwhite.min.css" | relURL }}">

    <!-- zangshang CSS -->
    <link rel="stylesheet" href="{{ "css/zanshang.min.css" | relURL }}">

    <!-- Custom Fonts -->
    <link rel="stylesheet" href="{{ "css/font-awesome.all.min.css" | relURL }}">

    <!-- KaTeX CSS  -->
    {{ $noop := .WordCount }}
    {{ if .Page.Store.Get "hasMath" -}}
        {{ partial "math/katex-css.html" . -}}
        {{ partial "math/katex-fonts.html" . -}}
    {{ end -}}

    <!--  Custom CSS  -->
    {{ range .Site.Params.custom_css -}}
    <link rel="stylesheet" href="{{ . | absURL }}">
    {{- end }}

    <!-- jQuery -->
    <script src="{{ "js/jquery.min.js" | relURL }}"></script>

    <!-- Bootstrap Core JavaScript -->
    <script src="{{ "js/bootstrap.min.js" | relURL }}"></script>

    <!-- Hux Theme JavaScript -->
    <script src="{{ "js/hux-blog.min.js" | relURL }}"></script>

    <!-- lazy load image JavaScript -->
    <script src="{{ "js/lazysizes.min.js" | relURL }}"></script>

    <!-- Custom JS -->
    {{ range .Site.Params.custom_js }}
    <script src="{{ . | absURL }}"></script>
    {{ end }}

    <!-- Custom Styles -->
    <style>
    .article-description {
      text-align: center;
      font-size: 1.1em;
      color: #777;
      margin: 15px 0 25px 0;
      font-style: italic;
      font-weight: 400;
    }
    .article-subtitle {
      text-align: center;
      font-size: 1.3em;
      color: #555;
      margin: 20px 0 30px 0;
      font-weight: 500;
    }
    .section-title {
      text-align: center;
      font-size: 1.2em;
      color: #666;
      margin: 30px 0 20px 0;
      font-weight: 500;
    }
    </style>

    <!-- Prevent title from wrapping awkwardly -->
    <style>
    .post-heading h1 {
      word-break: keep-all;
      overflow-wrap: break-word;
      hyphens: none;
    }

    /* Typing Cursor Effect */
    .typing-cursor {
      display: inline-block;
      width: 2px;
      height: 1.2em;
      background-color: #0085a1;
      margin-left: 2px;
      animation: blink 1s infinite;
      vertical-align: middle;
    }

    @keyframes blink {
      0%, 50% { opacity: 1; }
      51%, 100% { opacity: 0; }
    }
    </style>

    <!-- Typing Effect Script -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Typing effect for homepage slogan
      const subheading = document.querySelector('.site-heading .subheading');
      if (subheading && window.location.pathname === '/') {
        const text = subheading.textContent;
        subheading.innerHTML = '<span class="typing-cursor"></span>';

        const cursor = subheading.querySelector('.typing-cursor');
        const textSpan = document.createElement('span');
        subheading.insertBefore(textSpan, cursor);

        let index = 0;
        const speed = 100; // ms per character

        // Blink cursor for 1 second before typing
        setTimeout(function() {
          function typeWriter() {
            if (index < text.length) {
            textSpan.textContent += text.charAt(index);
            index++;
            setTimeout(typeWriter, speed);
            }
          }
        typeWriter();
        }, 1000);
      }
    });
    </script>

    <!-- Lightbox for Images -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/css/lightbox.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/lightbox2/2.11.3/js/lightbox-plus-jquery.min.js"></script>
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize lightbox for all article images
      lightbox.option({
        'resizeDuration': 200,
        'wrapAround': true,
        'fadeDuration': 200,
        'imageFadeDuration': 200,
        'disableScrolling': true,
        'fitImagesInViewport': true
      });

      // Add lightbox to article images
      document.querySelectorAll('.post-container img, .album-cover img').forEach(function(img) {
        if (!img.closest('a')) { // Only if not already wrapped in link
          const src = img.src;
          const alt = img.alt || 'Image';
          const link = document.createElement('a');
          link.href = src;
          link.setAttribute('data-lightbox', 'post-image');
          link.setAttribute('data-title', alt);
          link.style.display = 'inline';
          img.parentNode.insertBefore(link, img);
          link.appendChild(img);
        }
      });
    });
    </script>
    <style>
    /* Lightbox Customization */
    .lb-image { max-height: 90vh; }
    .lb-dataContainer { max-width: 100%; }
    </style>

    <!-- Code Copy Button Script -->
    <script>
    document.addEventListener('DOMContentLoaded', function() {
      document.querySelectorAll('pre code').forEach(function(block) {
        const button = document.createElement('button');
        button.className = 'copy-btn';
        button.textContent = 'Copy';
        button.style.cssText = 'position:absolute;top:8px;right:8px;background:rgba(0,0,0,0.7);color:#fff;border:none;padding:4px 8px;border-radius:4px;font-size:12px;cursor:pointer;opacity:0;transition:opacity 0.2s';
        block.parentElement.style.position = 'relative';
        block.parentElement.appendChild(button);

        button.addEventListener('click', function() {
          navigator.clipboard.writeText(block.textContent).then(function() {
            button.textContent = 'Copied!';
            setTimeout(function() { button.textContent = 'Copy'; }, 2000);
          });
        });
      });

      document.querySelectorAll('pre').forEach(function(pre) {
        pre.addEventListener('mouseenter', function() {
          this.querySelector('.copy-btn').style.opacity = '1';
        });
        pre.addEventListener('mouseleave', function() {
          this.querySelector('.copy-btn').style.opacity = '0';
        });
      });
    });
    </script>

    <style>
    pre code { padding: 16px; border-radius: 6px; font-size: 14px; background: #f6f8fa; }
    .post-container code:not(pre code) { background: #f6f8fa; padding: 2px 6px; border-radius: 3px; color: #0085a1; font-size: 0.9em; }
    </style>

</head>

{{ if .Site.Config.Services.GoogleAnalytics.ID }}
{{ template "_internal/google_analytics.html" . }}
{{ end }}
